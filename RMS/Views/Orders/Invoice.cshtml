@model OrderViewModel
@{
    ViewData["Title"] = "Hóa đơn";
    var vatRate = 0.08M;
    var subtotal = Model.Dishes.Sum(d => d.Price * d.Quantity);
    var vat = Math.Round(subtotal * vatRate, 0);
    var discount = 0M; // Nếu có giảm giá thì truyền vào Model
    var total = subtotal + vat - discount;
}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <title>Hóa đơn thanh toán</title>
    <script src="/js/invoice-style.js"></script>
</head>
<body>
    <div class="invoice-container">
        <div class="header">
            <img src="/images/logo.png" alt="Restaurant Logo" class="logo" onerror="this.style.display='none'" />
            <div class="title">HÓA ĐƠN THANH TOÁN</div>
            <div class="address">Nhà hàng ABC, 123 Đường Lớn, Quận 1, TP.HCM</div>
            <div class="meta">Mã đơn: <b>#@Model.Id</b> | Bàn: <b>@Model.TableNumber</b></div>
            <div class="meta">Thời gian: <b>@(Model.CreatedAt?.ToString("HH:mm dd/MM/yyyy") ?? "-")</b></div>
        </div>
        <table class="invoice-details">
            <thead>
                <tr>
                    <th>Món</th>
                    <th>SL</th>
                    <th>Đơn giá</th>
                    <th>Thành tiền</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.Dishes)
                {
                    <tr>
                        <td>@item.Name</td>
                        <td>@item.Quantity</td>
                        <td>@item.Price.ToString("N0") ₫</td>
                        <td>@((item.Price * item.Quantity).ToString("N0")) ₫</td>
                    </tr>
                }
            </tbody>
        </table>
        <table style="width:100%; margin-bottom: 10px;">
            <tr class="totals-row">
                <td class="label" colspan="3">Tạm tính:</td>
                <td class="value">@subtotal.ToString("N0") ₫</td>
            </tr>
            <tr class="totals-row">
                <td class="label" colspan="3">VAT (8%):</td>
                <td class="value">@vat.ToString("N0") ₫</td>
            </tr>
            @if (discount > 0)
            {
            <tr class="totals-row">
                <td class="label" colspan="3">Giảm giá:</td>
                <td class="value">-@discount.ToString("N0") ₫</td>
            </tr>
            }
            <tr class="totals-row">
                <td class="label" colspan="3">TỔNG CỘNG:</td>
                <td class="value" style="font-size:1.2rem; color:#e53e3e;">@total.ToString("N0") ₫</td>
            </tr>
        </table>
        <div style="text-align:center; color:#4a5568; font-size:0.98rem; margin-top:18px;">Cảm ơn quý khách và hẹn gặp lại!</div>
        <button class="print-btn" onclick="window.print()">In hóa đơn</button>
    </div>
</body>
</html>
